---
Created: 2020-02-06T00:58
Updated: 2020-02-10T10:56
---
腹回り、というかヘソ周径79cm。80未満ながら体感としては三段腹が著しい。トシとったなあと思わせてくれる。腕は細いままなのに。

2020 2月 06（木）,00:58

Rails演習5【Rails一問一答】

今日はここから。

復習で午前中全部使っちまったが、まあ昨日の進みが良かっただけに仕方ない。30分じゃ終わらんよ

14:42

よーし、ツイッタークローンの課題をやるぞ。

せっかくだからスキャフォールドの機能を試してみようかな？

Railsチュートリアルの２章がそのまんまのスキャフォールドによるマイクロブログ作成だったはず。

正直、サービスを作りましょう！と言われてもやる気より面倒臭さの方が上回っており、とてもクリエイティブな気質を己の内面に感じることができない。

だが、DICの初回面談で実演されたスキャフォールドは、いつか使ってみたいと思っていたのだ。今はそれで十分だろう。時間も余裕が無いし。

スキャフォールドでそのまま作ると、テストフォルダとかナントカも自動作成される。

余分なものを除いてから提出する、必要がある、はず。

実行する前に、ちゃんとチュートリアル２章を読み終わってからにするか。

Diverの、

命名規約に則ったファイルやクラスを生成することで、管理しやすいアプリケーションになります。

＞これだ。いたずらに「Tukou」とか書くよりも、規約に沿ったマイクロポストのファイル名にすれば、テンプレの揃い方も良いはずだ。CoCってやつだ。

スキャフォールドよりもさらに一つ前、Railsプロジェクトを開始するための儀式？

rails new なんてやったっけ？？？

＞rails new appname --database=postgresql

そういやデータベース指定とかするコマンドを叩いたっけ

```Plain
下記rails gコマンドによって生成されるファイルを参考に、命名規則を覚えていきましょう。
rails g scaffold blog title:string content:text
```

2.3.2 マイクロポストをマイクロにする

＞140字制限はこの章そのまま使えばいいな。

カレントディレクトリが”sample”であることを確認して、以下のコマンドを実行します。

```Plain
$ rails db:create
```

2>これがないとデータベースが真のすっからかんなので、アクセスする空間すら無い。

ゆえにサーバー起動しても、アクセスする着地点が無いのでエラーになる。ちゃんと「データベースがないぞ！」というメッセージで。

```Plain
$ bundle init


```

は無視した。今はGemの偉大さがまだ良くわからんし、足らなきゃあとから足せばいいし、そのやり方も知っている。

```Plain
rails generate scaffold Toukou content:text
```

スキャフォールド実行。

あれ？思ったより短い時間で終わった。じゃあ、デモで俺が驚いたシーンは、GenerateじゃなくてNewのメソッドの場面だったのか？？

まあいい、これで新規投稿、編集、戻る、削除はあっという間に標準装備された。

確認画面はテキスト通り追加すればいいだろう。

タイムゾーンの変更はConfigファイルで行い、その後に設定変更の反映を見るには、

Railsコンソールで、

```Plain
コンソールを起動したら、Time.currentやTime.zoneを実行します。UTC +00:00、@name=”UTC” となっており、デフォルトだとUTCで動作しているのがわかりますね。
irb(main):001:0> Time.current
=> Sat, 29 Jun 2019 07:00:14 UTC +00:00
```

＞設定を終えると、無事　JST　表記に変わっている。

確認画面。

Diverの３０にある、

```Plain
collection do
        post :confirm
      end
```

これをそのまま使うとルーティングエラーが起きる。rails routesが全滅する。

リファレンス読まないとすぐには使えないな。

>使えちゃった。コピペした時点じゃENDの数が足らなかったらしい？

Resourcesのルーティングのネストとかいう技術も検索に引っかかったが、結局よくわからない。

１，ルーティングしなおし、

２，HTML画面を作って、

３，メソッドとの関連付けが不十分。新規作成、編集画面の両方で、Privateメソッドにひっかかる。ストロングパラメーターとは違うほうだ。

削除は出来る。読むのも出来る。

編集＞見る　もOK

編集＞戻る　もOK

多次元ハッシュ、2階層ハッシュ、というような呼び方。

---

ブログモデルのインスタンスをインスタンス変数に代入します。「コントローラでインスタンス変数に値を代入し、そのインスタンス変数をビューで用いる」という流れが基本です。

＞ちゃんとお断りがあったなあ。

多次元ハッシュ、2階層ハッシュ、というような呼び方。

この場合、「HTTPメソッドがGETで、/patients/（3など、実際のレコードのid値）というURLのリクエストが流れてくれば

＞ルーティングテーブルファイルは「流れてくる場所」であり、流しているのは画面の前のユーザーだということを忘れるな。あくまでルーティングのファイルはあくまで受け身の姿勢だ

アクションのメソッドが実行される前に実行するためには、before_actionメソッドを実行します。

＞ストロングパラメーターとごっちゃになってたが、全然違うもの。

＞これは似たような画面をまとめる、処理の共通化のときに使う技術として紹介されている。

そこで **パーシャル** と呼ばれるViewの部分テンプレート（ある特定のhtmlページを共通化したもの）を用いて共通のViewをリファクタリングしていきましょう。

＞全面ではなく部分的なテンプレ化、だから、パーシャルという名前なのだった。

Noticeはビューじゃなくてコントローラーが出力している

```Plain
noticeオプションを使うことでフラッシュメッセージを表示できるようになる。
```

＞これ。

そこで、送られてきた値は保持するが表示はしないform.hidden_fieldを使用して、入力フォームを生成せず、new Viewからきた値をそのまま、confirmアクションに渡すようにします。

＞つまり、Confirm画面は同じFormの部分テンプレをつかっているので、内部的には入力された数値を持っており、それを隠しながら見せている、という表示形式らしい。

＞（内部的には同じHTMLっぽいが、入力フォームなどの部品を一部分だけHiddenで隠しているので、別画面に見える、というからくり。

一晩明けても、Rails入門３１は難しいな。言いたいことは分かるが、その解決方法についての理屈がどうも分からん。

画面を言ったり来たりされると遷移をコントロールする値がこちらの想定外になることが有るのでそれを防げ、ということなんだろうが、

＞かつ、ユーザーが入力した内容を保持する値を消さないまま画面を移動するテクニック、ということか

＞ヘルパーメソッド、画面遷移と戻るボタン、他のテキストで図がほしいな

その設計方法とはデータ(Data)、コンテキスト(Context)、相互作用(Interaction) パターン(DCI) に基づくものである。

＝DCIアーキテクチャ。MVCのような、ソフトウェア設計のデザインパターンのひとつ。

「振る舞い」が具体的に何を意味するのか、著者は口座オブジェクトを例に挙げた。例えば、口座オブジェクトは、残高を減らしたり、預金を引き出したりすることができる。Coplien氏とReenskaug氏によれば、「この2つの振る舞いは、根本的に違う。残高を減らす行為は、『どういう状態にあるか』というデータの特性にすぎない。しかし、預金を引き出すという行為は、『何をするのか』というデータの目的を反映する。」のである。 どのような状況であれ、残高を減らすことができるという事実はデータの特性を示し、変動しない。対して、預金を引き出すことは「ATMの画面や音声ガイドとのやりとり」を含み 、動的であり、『どうあるか』ではなく『どうするか』にかかわる問題である。

＞なるほどねえ、オブジェクト指向を考え始めるとこういう点にまで行き着くわけか。

13:04

復習がようやく終わった。3時間？？？　結構急いで読むよう努めてたのだが。

「service」コマンド で postgresql サービスを起動します。「/etc/init.d/postgresql start」と実行するのと同じです。

```Plain
rails db:migrate:reset
```

でデータベースを削除してまっさらな状態にしてから**全て**の**マイグレーション**を**やり直し**できます。

### Q. schema.rbを見て、テーブルの状態を確認するは、SQLを使用してテーブルの状態を確認する場合とくらべてどのようなメリットがあるか

A.

スキーマファイルは、ActiveRecordのオブジェクトにどのような属性があるのかを概観するのに便利です。

スキーマ情報は多くのマイグレーションに分かれて存在しており、

そのままでは非常に探しにくいですが、スキーマファイルにコンパクトにまとまっています。

### Q. 【応用】実は、schema.rbの役割はテーブルの状態を確認するだけではない、schema.rbが他にどのような役割を担っているか調べよ

A.

rails db:schema:dump

db:migrate、db:rollback などが依存している。

現在のスキーマからschema.rbを作成する。

rails db:schema:load

db:setup、db:reset などが依存している。

schema.rbからテーブルを作成する。

ラボ型開発　モフモフ　アジャイル形

2020 2月 06（木）,20:56

仕様が決めきれてないから

会社が選べる

2020 2月 06（木）,20:56

ウェブデザイン系がレールズに手を出したパターンの会社

マルクデザイン社

技術そこそこ　未経験でも入りやすいが

技術イマイチだから教育制度もよくない

2020 2月 06（木）,20:58

ジャ下さい

2020 2月 06（木）,20:58

就職担当者に求人案件を見て評価してもらうこともあり

2020 2月 06（木）,21:02

一年で慣れる！？

2020 2月 06（木）,21:42

業界を三つくらいにしぼると探しやすい

2020 2月 06（木）,21:42

業界を三つくらいにしぼると探しやすい

2020 2月 06（木）,21:42

業種よりは業界を先に絞れ、と

2020 2月 06（木）,21:42

クラウドワークス　クックパッドとか、企業主さいの勉強会

2020 2月 06（木）,21:42

経験3年のルビープログラマよりphpの方が探しやすいから

2020 2月 06（木）,21:43

週イチでもいいから就職活動しろ！？

勉強会のLTで目立つ

一分間で経歴を！

あー、こういうところで英語スピーチとかして目立とうとすれば良いのかな？

即対訳をつけて話せばポカーンとはされにくいだろう。

2020 2月 06（木）,21:47

ウェブ系なら、受託でも、おそらくnttデータや富士通とは関わらない、かも

2020 2月 11（火）,21:25