---
Created: 2020-04-26T13:17
Updated: 2020-04-29T03:42
---
AWSデプロイ作業

15:00

まーたsource /etc/profile.d/rbenv.sh　が走らない。構文エラー（EOF)となる。

だがSSH接続は成功する。これは前回とはちょっとちがう。前回の失敗時はパスワード入力が求められていたのでSSH接続は失敗していた。

15:04

ふと思い直し、このファイル内に書き込んだ環境変数の中身をVIMで見直し、更新しなおして（閲覧中に誤って”を消したので書き直して保存し）再度sourceコマンドを叩いたらアッサリ通った。

わからん・・・。

（いや、間に質問欄にあったようにインスタンスの再起動をしたんだっけ？）

16:24

課題ではパスした、S3の画像アップロード設定にとりかかる。だが、バケット作成のACL設定がDiverと変わっている。どう設定したものか？

とりあえず課題だけやりすごせばいいんだからここは全部許可にしちゃえ。

本気でこのサービスを使うなら、Dockerとか入れ直してまたサーバーを立て直すんだからあとあといくらでも変更することがある。数日くらい別に大したセキュリティ問題にはならんだろ

ステップ３、タグ

name

RR-production

authorized_keys

/etc/init.d/nginx start

sudo vi /etc/nginx/conf.d/RR.conf

事故った。git checkoutしてdevelopブランチからmasterブランチに切り替えたときに、それまで書き込んでいたファイルがいくつか消えてしまったようだ。

もう一度頭からやり直さなくてはならないか？

それとも、developブランチを展開して、設定ファイルのmasuter記述をdevelopに変えるか？

17:28　ともかく一旦休憩。

config/database.yml

これのデータベース名、ユーザー名は大文字にすると内部的に小文字に変わってしまう？

とりあえずこのymlの中身をrrに書き直してみよう

RR_production

bundler: failed to load command: unicorn (/var/www/RR/shared/bundle/ruby/2.6.0/bin/unicorn)

/usr/local/rbenv/bin/rbenv exec bundle install --path /var/www/RR/shared/bundle

22:24

unicornがAWS上で起動しないのが悪いらしい。

aws_access_key_id: ENV["AWSAccessKeyId"],

aws_secret_access_key: ENV["AWSSecretKey"],

が読み取れないので引数エラーとなるそうだが、これはDiverと実際にダウンロードしたものとで名前が違う。大丈夫？

シークレットアクセスキー　じゃなくて、シークレットキー、になっているのだが？

問題のエラーはこれなのだから、シークレットアクセスキー、に合わせる方が正解か？

ArgumentError: Missing required arguments: aws_access_key_id, aws_secret_access_key

13:27

今日で制作１０日目か。要件定義も含めると１７日目？

16:45

Diverにて、AWSアクセスキーを.envに追加した手順の後。これってどういう意味だ？？？

```Plain
これで、S3にアップロードできるようになりました。(開発環境のみ)
```

2020 4月 26（日）,13:17

```Plain
dktohgohxvtomaixe:RR apple$ env | grep rb
PATH=/Users/apple/.rbenv/shims:~/.rbenv/shims:/usr/local/bin:/Users/apple/.rbenv/shims:/Users/apple/.rbenv/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
```

env でgrepすれば、その環境での環境変数が表示される